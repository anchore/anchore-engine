{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "vulnerability_report.schema.json",
  "definitions": {
    "report_metadata": {
      "properties": {
        "generated_at": {
          "title": "generated_at",
          "type": "string"
        },
        "generated_by": {
          "type": "object"
        },
        "uuid": {
          "title": "uuid",
          "type": "string"
        }
      },
      "type": "object"
    },
    "scan_problem": {
      "properties": {
        "details": {
          "title": "details",
          "type": "string"
        }
      },
      "type": "object"
    },
    "vulnerability_match": {
      "properties": {
        "artifact": {
          "type": "object",
          "$ref": "#/definitions/artifact"
        },
        "fixes": {
          "title": "fixes",
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/fixed_artifact"
          }
        },
        "match": {
          "type": "object",
          "$ref": "#/definitions/match"
        },
        "vulnerability": {
          "type": "object",
          "$ref": "#/definitions/vulnerability"
        }
      },
      "type": "object"
    },
    "artifact": {
      "properties": {
        "cpe": {
          "title": "cpe",
          "type": "string"
        },
        "cpe23": {
          "title": "cpe23",
          "type": "string"
        },
        "name": {
          "title": "name",
          "type": "string"
        },
        "pkg_path": {
          "title": "pkg_path",
          "type": "string"
        },
        "pkg_type": {
          "title": "pkg_type",
          "type": "string"
        },
        "version": {
          "title": "version",
          "type": "string"
        }
      },
      "type": "object"
    },
    "fixed_artifact": {
      "properties": {
        "observed_at": {
          "title": "observed_at",
          "type": ["string", "null"]
        },
        "version": {
          "title": "version",
          "type": "string"
        },
        "wont_fix": {
          "title": "wont_fix",
          "type": "boolean"
        }
      },
      "type": "object"
    },
    "match": {
      "properties": {
        "detected_at": {
          "title": "detected_at",
          "type": "string"
        }
      },
      "type": "object"
    },
    "vulnerability": {
      "properties": {
        "created_at": {
          "title": "created_at",
          "type": "string"
        },
        "cvss_scores_nvd": {
          "title": "cvss_scores_nvd",
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/cvss_combined"
          }
        },
        "cvss_scores_vendor": {
          "title": "cvss_scores_vendor",
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/cvss_combined"
          }
        },
        "description": {
          "title": "description",
          "type": "string"
        },
        "feed": {
          "title": "feed",
          "type": "string"
        },
        "feed_group": {
          "title": "feed_group",
          "type": "string"
        },
        "last_modified": {
          "title": "last_modified",
          "type": "string"
        },
        "link": {
          "title": "link",
          "type": "string"
        },
        "severity": {
          "title": "severity",
          "type": "string"
        },
        "vulnerability_id": {
          "title": "vulnerability_id",
          "type": "string"
        }
      },
      "type": "object"
    },
    "cvss_combined": {
      "properties": {
        "cvss_v2": {
          "type": "object",
          "$ref": "#/definitions/cvss_score"
        },
        "cvss_v3": {
          "type": "object",
          "$ref": "#/definitions/cvss_score"
        },
        "id": {
          "title": "id",
          "type": "string"
        }
      },
      "type": "object"
    },
    "cvss_score": {
      "properties": {
        "base_score": {
          "title": "base_score",
          "type": "number",
          "format": "float"
        },
        "exploitability_score": {
          "title": "exploitability_score",
          "type": "number",
          "format": "float"
        },
        "impact_score": {
          "title": "impact_score",
          "type": "number",
          "format": "float"
        }
      },
      "type": "object"
    }
  },
  "type": "object",
  "properties": {
    "image_id": {
      "title": "image_id",
      "type": "string"
    },
    "metadata": {
      "type": "object",
      "$ref": "#/definitions/report_metadata"
    },
    "problems": {
      "title": "problems",
      "type": "array",
      "items": {
        "type": "object",
        "$ref": "#/definitions/scan_problem"
      }
    },
    "results": {
      "title": "results",
      "type": "array",
      "items": {
        "type": "object",
        "$ref": "#/definitions/vulnerability_match"
      }
    },
    "account_id": {
      "title": "account_id",
      "type": "string"
    }
  }
}